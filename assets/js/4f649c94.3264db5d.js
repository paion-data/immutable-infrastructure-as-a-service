"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[840],{716:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>P,contentTitle:()=>S,default:()=>E,frontMatter:()=>I,metadata:()=>C,toc:()=>D});var t=n(4848),i=n(8453),s=n(6540),r=n(53),o=n(3104),l=n(6347),c=n(205),d=n(7485),h=n(1682),u=n(9466);function p(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:a}=e;return!!a&&"object"==typeof a&&"value"in a}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function m(e){const{values:a,children:n}=e;return(0,s.useMemo)((()=>{const e=a??function(e){return p(e).map((e=>{let{props:{value:a,label:n,attributes:t,default:i}}=e;return{value:a,label:n,attributes:t,default:i}}))}(n);return function(e){const a=(0,h.X)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,n])}function g(e){let{value:a,tabValues:n}=e;return n.some((e=>e.value===a))}function f(e){let{queryString:a=!1,groupId:n}=e;const t=(0,l.W6)(),i=function(e){let{queryString:a=!1,groupId:n}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:a,groupId:n});return[(0,d.aZ)(i),(0,s.useCallback)((e=>{if(!i)return;const a=new URLSearchParams(t.location.search);a.set(i,e),t.replace({...t.location,search:a.toString()})}),[i,t])]}function x(e){const{defaultValue:a,queryString:n=!1,groupId:t}=e,i=m(e),[r,o]=(0,s.useState)((()=>function(e){let{defaultValue:a,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!g({value:a,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:a,tabValues:i}))),[l,d]=f({queryString:n,groupId:t}),[h,p]=function(e){let{groupId:a}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(a),[t,i]=(0,u.Dv)(n);return[t,(0,s.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:t}),x=(()=>{const e=l??h;return g({value:e,tabValues:i})?e:null})();(0,c.A)((()=>{x&&o(x)}),[x]);return{selectedValue:r,selectValue:(0,s.useCallback)((e=>{if(!g({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),p(e)}),[d,p,i]),tabValues:i}}var y=n(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function v(e){let{className:a,block:n,selectedValue:i,selectValue:s,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.a_)(),h=e=>{const a=e.currentTarget,n=c.indexOf(a),t=l[n].value;t!==i&&(d(a),s(t))},u=e=>{let a=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;a=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;a=c[n]??c[c.length-1];break}}a?.focus()};return(0,t.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},a),children:l.map((e=>{let{value:a,label:n,attributes:s}=e;return(0,t.jsx)("li",{role:"tab",tabIndex:i===a?0:-1,"aria-selected":i===a,ref:e=>c.push(e),onKeyDown:u,onClick:h,...s,className:(0,r.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":i===a}),children:n??a},a)}))})}function j(e){let{lazy:a,children:n,selectedValue:i}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(a){const e=r.find((e=>e.props.value===i));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,t.jsx)("div",{className:"margin-top--md",children:r.map(((e,a)=>(0,s.cloneElement)(e,{key:a,hidden:e.props.value!==i})))})}function w(e){const a=x(e);return(0,t.jsxs)("div",{className:(0,r.A)("tabs-container",b.tabList),children:[(0,t.jsx)(v,{...e,...a}),(0,t.jsx)(j,{...e,...a})]})}function k(e){const a=(0,y.A)();return(0,t.jsx)(w,{...e,children:p(e.children)},String(a))}const _={tabItem:"tabItem_Ymn6"};function A(e){let{children:a,hidden:n,className:i}=e;return(0,t.jsx)("div",{role:"tabpanel",className:(0,r.A)(_.tabItem,i),hidden:n,children:a})}const I={sidebar_position:1,title:"General Deployment",description:"Deploying Kong API Gateway via Native HashiCorp Commands"},S="Deploying Kong API Gateway",C={id:"kong-api-gateway/index",title:"General Deployment",description:"Deploying Kong API Gateway via Native HashiCorp Commands",source:"@site/docs/kong-api-gateway/index.mdx",sourceDirName:"kong-api-gateway",slug:"/kong-api-gateway/",permalink:"/docs/kong-api-gateway/",draft:!1,unlisted:!1,editUrl:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/docs/docs/kong-api-gateway/index.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"General Deployment",description:"Deploying Kong API Gateway via Native HashiCorp Commands"},sidebar:"docSidebar",previous:{title:"Kong API Gateway",permalink:"/docs/category/kong-api-gateway"},next:{title:"Deployment via Screwdriver CD",permalink:"/docs/kong-api-gateway/screwdriver-cd-deployment"}},P={},D=[{value:"General Deployments",id:"general-deployments",level:2},{value:"Defining Packer Variables",id:"defining-packer-variables",level:3},{value:"Defining Terraform Variables",id:"defining-terraform-variables",level:3},{value:"Building AMI Image",id:"building-ami-image",level:3},{value:"Deploying to EC2",id:"deploying-to-ec2",level:3},{value:"Deployment via Screwdriver CD",id:"deployment-via-screwdriver-cd",level:2},{value:"Deployment via IICP",id:"deployment-via-iicp",level:2}];function T(e){const a={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.h1,{id:"deploying-kong-api-gateway",children:"Deploying Kong API Gateway"}),"\n",(0,t.jsxs)(a.p,{children:["IIaaS deploys ",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/docker-kong",children:"Kong API Gateway"})," in the following way:"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["Deploys ",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/docker-kong",children:"Kong API Gateway"})," in ",(0,t.jsx)(a.strong,{children:"HTTP"})," mode"]}),"\n",(0,t.jsxs)(a.li,{children:["Deploys a reverse proxy Nginx in front of the ",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/docker-kong",children:"Kong API Gateway"})," in the same EC2 to redirect all HTTPS request to\ngateway's ",(0,t.jsx)(a.a,{href:"https://docs.konghq.com/gateway/latest/production/networking/default-ports/",children:"corresponding"})," HTTP ports"]}),"\n"]}),"\n",(0,t.jsx)(a.p,{children:"The diagrams below illustrates the resulting deployment"}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"Error loading kong-deployment-diagram.png",src:n(8952).A+"",width:"2778",height:"728"})}),"\n",(0,t.jsx)(a.h2,{id:"general-deployments",children:"General Deployments"}),"\n",(0,t.jsx)(a.admonition,{type:"info",children:(0,t.jsxs)(a.p,{children:["Please complete the ",(0,t.jsx)(a.a,{href:"../setup#setup",children:"general setup"})," before proceeding."]})}),"\n",(0,t.jsxs)(a.admonition,{title:"Supporting HTTPS Protocol",type:"tip",children:[(0,t.jsxs)(a.p,{children:["IIaaS uses a ",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/docker-kong",children:"customized fork of docker-kong"})," to\n",(0,t.jsx)(a.a,{href:"https://github.com/QubitPi/docker-kong/pull/1",children:"fully separate the app and SSL"}),", and, therefore, the Nginx config needs\nmultiple ",(0,t.jsx)(a.a,{href:"https://www.nginx.com/resources/wiki/start/topics/examples/server_blocks/",children:"servers"}),"\nto ensure all HTTPS ports are mapped to their corresponding HTTP ports as shown in the config snippet below:"]}),(0,t.jsxs)(a.admonition,{type:"note",children:[(0,t.jsxs)(a.p,{children:["All relevant HTTP and HTTPS ports are listed in ",(0,t.jsx)(a.a,{href:"https://docs.konghq.com/gateway/latest/production/networking/default-ports/",children:"Kong's documentation here"}),". In general,\nour Nginx should **listen on an HTTPS port and ",(0,t.jsx)(a.code,{children:"proxy_pass"})," to an HTTP port. For example, ports 8443 and 8444 are\n",(0,t.jsx)(a.code,{children:"proxy_pass"}),"ed to 8000 and 8001, respectively, both of which are listed in the doc."]}),(0,t.jsx)(a.p,{children:"One special case is HTTP port 8000, which is the redirect port. iiaas maps the standard SSL 443 port to 8000 so that any\ndownstream (such as UI web app) simply needs to hit the domain without specifying port number and have its request be\nreidrected to upstream services (such as database webservice)"}),(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"Error loading kong-ports-diagram.png",src:n(932).A+"",width:"1662",height:"1064"})})]})]}),"\n",(0,t.jsx)(a.h3,{id:"defining-packer-variables",children:"Defining Packer Variables"}),"\n",(0,t.jsxs)(k,{children:[(0,t.jsxs)(A,{value:"alicloud",label:"Alicloud",default:!0,children:[(0,t.jsxs)(a.p,{children:["Create a [HashiCorp Packer variable values file] named ",(0,t.jsx)(a.strong,{children:"ali-kong.auto.pkrvars.hcl"})," under\n",(0,t.jsx)(a.strong,{children:(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/images",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images"})})," directory with the following contents:"]}),(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-hcl",metastring:'title="immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images/ali-kong.auto.pkrvars.hcl"',children:'ali_image_name          = "my-kong-ecs"\ninstance_type           = "my-kong-ami"\nregion                  = "cn-shenzhen"\nssl_cert_source         = "/path/to/ssl.crt"\nssl_cert_key_source     = "/path/to/ssl.key"\nkong_api_gateway_domain = "gateway.mycompany.com"\n'})}),(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ali_image_name"})," is the ",(0,t.jsx)(a.a,{href:"https://www.alibabacloud.com/product/ecs",children:"Alicloud ECS"})," image name, which can be either English or Chinese characters. It can begin\nwith an uppercase/lowercase letter or a Chinese character, and may contain numbers, ",(0,t.jsx)(a.code,{children:"_"})," or ",(0,t.jsx)(a.code,{children:"-"}),", but cannot begin\nwith ",(0,t.jsx)(a.code,{children:"http://"})," or ",(0,t.jsx)(a.code,{children:"https://"})]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"instance_type"})," is the ",(0,t.jsx)(a.a,{href:"https://www.alibabacloud.com/help/doc-detail/25378.htm",children:"type of the machine"})," for building the ECS image."]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"region"})," is the ",(0,t.jsx)(a.a,{href:"https://www.alibabacloud.com/help/en/cloud-migration-guide-for-beginners/latest/regions-and-zones",children:"Alicloud region ID"})," which hosts the ECS instance that is used to build the image."]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ssl_cert_source"})," is the absolute path or the path relative to\n",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/images",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images"})," of the\n",(0,t.jsx)(a.a,{href:"../setup#ssl",children:"SSL certificate file"})," for the Kong API Gateway domain"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ssl_cert_key_source"})," is the absolute path or the path relative to\n",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/images",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images"})," of the\n",(0,t.jsx)(a.a,{href:"../setup#ssl",children:"SSL certificate key file"})," for the Kong API Gateway domain"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"kong_api_gateway_domain"})," is the SSL-enabled domain that will serve the\n",(0,t.jsx)(a.a,{href:"https://docs.konghq.com/gateway/latest/production/networking/default-ports/",children:"various ports of Kong gateway"})]}),"\n"]})]}),(0,t.jsxs)(A,{value:"aws",label:"AWS",children:[(0,t.jsxs)(a.p,{children:["Create a [HashiCorp Packer variable values file] named ",(0,t.jsx)(a.strong,{children:"aws-kong.auto.pkrvars.hcl"})," under\n",(0,t.jsx)(a.strong,{children:(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/images",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images"})})," directory with the following contents:"]}),(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-hcl",metastring:'title="immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images/aws-kong.auto.pkrvars.hcl"',children:'ami_region              = "us-east-1"\nami_name                = "my-kong-ami"\ninstance_type           = "t2.small"\nssl_cert_source         = "/path/to/ssl.crt"\nssl_cert_key_source     = "/path/to/ssl.key"\nkong_api_gateway_domain = "gateway.mycompany.com"\n'})}),(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ami_region"})," is the ",(0,t.jsx)(a.a,{href:"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html#Concepts.RegionsAndAvailabilityZones.Availability",children:"image region"})," where Kong API Gateway ",(0,t.jsx)(a.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html",children:"AMI"})," will be published to. The\npublished image will be ",(0,t.jsx)(a.em,{children:"private"})]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ami_name"})," is the published AMI name; it can be arbitrary"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"instance_type"})," is the ",(0,t.jsx)(a.a,{href:"https://aws.amazon.com/ec2/instance-types/",children:"AWS EC2 instance type"})," running this image"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ssl_cert_source"})," is the absolute path or the path relative to\n",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/images",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images"})," of the\n",(0,t.jsx)(a.a,{href:"../setup#ssl",children:"SSL certificate file"})," for the Kong API Gateway domain"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ssl_cert_key_source"})," is the absolute path or the path relative to\n",(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/images",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images"})," of the\n",(0,t.jsx)(a.a,{href:"../setup#ssl",children:"SSL certificate key file"})," for the Kong API Gateway domain"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"kong_api_gateway_domain"})," is the SSL-enabled domain that will serve the\n",(0,t.jsx)(a.a,{href:"https://docs.konghq.com/gateway/latest/production/networking/default-ports/",children:"various ports of Kong gateway"})]}),"\n"]})]})]}),"\n",(0,t.jsx)(a.h3,{id:"defining-terraform-variables",children:"Defining Terraform Variables"}),"\n",(0,t.jsxs)(k,{children:[(0,t.jsxs)(A,{value:"alicloud",label:"Alicloud",default:!0,children:[(0,t.jsxs)(a.p,{children:["Create a ",(0,t.jsx)(a.a,{href:"https://developer.hashicorp.com/terraform/language/values/variables#variable-definitions-tfvars-files",children:"HashiCorp Terraform variable values file"})," named ",(0,t.jsx)(a.strong,{children:"ali-kong.auto.tfvars"})," under\n",(0,t.jsx)(a.strong,{children:(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/instances",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/instances"})})," directory with the following\ncontents:"]}),(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-hcl",metastring:'title="immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/instances/ali-kong.auto.tfvars"',children:"image_id        =\nvswitch_id      =\ninstance_type   =\ninstance_name   =\nsecurity_groups =\n"})})]}),(0,t.jsxs)(A,{value:"aws",label:"AWS",children:[(0,t.jsxs)(a.p,{children:["Create a ",(0,t.jsx)(a.a,{href:"https://developer.hashicorp.com/terraform/language/values/variables#variable-definitions-tfvars-files",children:"HashiCorp Terraform variable values file"})," named ",(0,t.jsx)(a.strong,{children:"aws-kong.auto.tfvars"})," under\n",(0,t.jsx)(a.strong,{children:(0,t.jsx)(a.a,{href:"https://github.com/paion-data/immutable-infrastructure-as-a-service/tree/master/hashicorp/kong-api-gateway/instances",children:"immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/instances"})})," directory with the following\ncontents:"]}),(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-hcl",metastring:'title="immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/instances/aws-kong.auto.tfvars"',children:'aws_deploy_region       = "us-east-1"\nami_name                = "my-kong-ami"\ninstance_type           = "t2.small"\ninstance_name           = "My Kong API Gateway"\nsecurity_groups         = ["My Kong API Gateway Security Group"]\nkong_api_gateway_domain = "gateway.mycompany.com"\nroute_53_zone_id        = "MBS8YLKZML18VV2E8M8OK"\n'})}),(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"aws_deploy_region"})," is the ",(0,t.jsx)(a.a,{href:"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html#Concepts.RegionsAndAvailabilityZones.Availability",children:"EC2 runtime region"})," where Kong will be deployed into"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"ami_name"})," is the name of the published AMI; ",(0,t.jsxs)(a.strong,{children:["it must be the same as the ",(0,t.jsx)(a.code,{children:"ami_name"})," in\n",(0,t.jsx)(a.a,{href:"#defining-packer-variables",children:"Packer variable file"})]})]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"instance_type"})," is the chosen ",(0,t.jsx)(a.a,{href:"https://aws.amazon.com/ec2/instance-types/",children:"AWS EC2 instance type"})," at runtime"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"instance_name"})," is the deployed EC2 name as appeared in the instance list of AWS console; it can be arbitrary"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"security_groups"})," is the list of ",(0,t.jsx)(a.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-groups.html",children:"AWS Security Group"})," ",(0,t.jsx)(a.em,{children:"names"})," to associate with (yes, not ID, but name...)"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"kong_api_gateway_domain"})," is the SSL-enabled domain that will serve ",(0,t.jsx)(a.a,{href:"https://docs.konghq.com/gateway/latest/kong-manager/",children:"Kong manager UI"})]}),"\n"]}),(0,t.jsxs)(a.admonition,{type:"warning",children:[(0,t.jsxs)(a.p,{children:["hashicorp-aws will bind a ",(0,t.jsx)(a.em,{children:"private"})," IP address to this domain for the following reasons:"]}),(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.a,{href:"https://serverfault.com/a/967483",children:"AWS security groups works for private IP only for DNS resolving"}),". Services\ninteracting with Kong gateway can use this domain."]}),"\n",(0,t.jsxs)(a.li,{children:["In the case of internal access, for example administrators visiting Kong Manager for config purposes, people can\nstill use ",(0,t.jsx)(a.code,{children:"https://public-dns:port"})]}),"\n"]})]}),(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"route_53_zone_id"})," is the AWS Route 53 hosted Zone ID that hosts the domain ",(0,t.jsx)(a.code,{children:"gateway.mycompany.com"})]}),"\n"]}),(0,t.jsxs)(a.admonition,{type:"tip",children:[(0,t.jsx)(a.p,{children:"To find the zone ID in AWS Route 53, we can:"}),(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsx)(a.li,{children:"Sign in to the AWS Management Console"}),"\n",(0,t.jsxs)(a.li,{children:["Open the Route 53 console at ",(0,t.jsx)(a.a,{href:"https://console.aws.amazon.com/route53/",children:"https://console.aws.amazon.com/route53/"})]}),"\n",(0,t.jsx)(a.li,{children:"Select Hosted zones in the navigation pane"}),"\n",(0,t.jsx)(a.li,{children:"Find the requested ID in the top level Hosted Zones summary in the Route 53 section"}),"\n"]})]})]})]}),"\n",(0,t.jsx)(a.h3,{id:"building-ami-image",children:"Building AMI Image"}),"\n",(0,t.jsxs)(k,{children:[(0,t.jsx)(A,{value:"alicloud",label:"Alicloud",default:!0,children:(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-console",children:'cd immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images\ncp alicloud/* .\npacker init .\npacker validate -var "skip_create_ami=true" .\npacker build -var "skip_create_ami=false" .\n'})})}),(0,t.jsx)(A,{value:"aws",label:"AWS",children:(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-console",children:'cd immutable-infrastructure-as-a-service/hashicorp/kong-api-gateway/images\ncp aws/* .\npacker init .\npacker validate -var "skip_create_ami=true" .\npacker build -var "skip_create_ami=false" .\n'})})})]}),"\n",(0,t.jsx)(a.h3,{id:"deploying-to-ec2",children:"Deploying to EC2"}),"\n",(0,t.jsxs)(k,{children:[(0,t.jsx)(A,{value:"alicloud",label:"Alicloud",default:!0,children:(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-console",children:"cd ../instances\ncp alicloud/* .\nterraform init\nterraform validate\nterraform apply -auto-approve\n"})})}),(0,t.jsx)(A,{value:"aws",label:"AWS",children:(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-console",children:"cd ../instances\ncp aws/* .\nterraform init\nterraform validate\nterraform apply -auto-approve\n"})})})]}),"\n",(0,t.jsx)(a.h2,{id:"deployment-via-screwdriver-cd",children:"Deployment via Screwdriver CD"}),"\n",(0,t.jsxs)(a.p,{children:["IIaaS supports deployment using ",(0,t.jsx)(a.a,{href:"screwdriver-cd-deployment",children:"Screwdriver CD"}),". Please check it out."]}),"\n",(0,t.jsx)(a.h2,{id:"deployment-via-iicp",children:"Deployment via IICP"}),"\n",(0,t.jsx)(a.admonition,{type:"tip",children:(0,t.jsx)(a.p,{children:"Please try our IICP platform to deploy a Kong instance. It gives us one-click experience that helps us stand up an API\ngateway in a minute."})})]})}function E(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(T,{...e})}):T(e)}},8952:(e,a,n)=>{n.d(a,{A:()=>t});const t=n.p+"assets/images/kong-deployment-diagram-0e603dd1e4fb96d8c09f228e1ff31894.png"},932:(e,a,n)=>{n.d(a,{A:()=>t});const t=n.p+"assets/images/kong-ports-diagram-94dd812152799d6acdc342b76be0588a.png"},8453:(e,a,n)=>{n.d(a,{R:()=>r,x:()=>o});var t=n(6540);const i={},s=t.createContext(i);function r(e){const a=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(s.Provider,{value:a},e.children)}}}]);